<script type="text/javascript">
    function generateUUID() { // Public Domain/MIT
      var d = new Date().getTime();
      if (typeof performance !== 'undefined' && typeof performance.now === 'function'){
          d += performance.now(); //use high-precision timer if available
      }
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
          var r = (d + Math.random() * 16) % 16 | 0;
          d = Math.floor(d / 16);
          return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);
      });
    }
    RED.nodes.registerType('alexa-local',{
        category: 'Alexa',
        color: '#3FADB5',
        defaults: {
            name: {value:""},
            devicename: {value:"", required:true}
        },
        inputs:0,
        outputs:1,
        icon: "alexa-local.png",
        label: function() {
            return this.devicename || "alexa-device";
        }
    });
</script>

<script type="text/x-red" data-template-name="alexa-local">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-devicename"><i class="icon-tag"></i> Device Name</label>
        <input type="text" id="node-input-devicename" placeholder="Ceiling light">
    </div>
    <div class="form-tips">Alexa uses this Device Name to indentify your device by voice. This has to be unique for each device. If you have renamed your device, please ask Alexa to discover again.</div>
</script>

<script type="text/x-red" data-help-name="alexa-local">
    <p>Note that this Node ID is used to uniquely identify & persist each device seen by Alexa or Google Home. If you delete and re-create this Node, the device is no longer the same. You would have to forget old device in Alexa app.</p>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">string | on/off</span>
        </dt>
        <dd> "on" or "off" trigger from Alexa.
             <br/>
             when dimming command is issued, this payload stay "on" as long as bri > 0%.
        </dd>
        <dt>bri <span class="property-type">float | 0.0-100.0</span></dt>
        <dd> support for dimming commands
             <br/>value ranges from 0.0 to 100.0 (percent). Use this property to get the variable level from dimming command such as "Alexa, dim the light to 49%".
             <br/>
             When dimming command is not used, this parameter will be 0.0 for "off" and 100.0 for "on" command.
        </dd>
        <dt>bri_normalized<span class="property-type">float | 0.0-1.0</span></dt>
        <dd> supports for dimming commands
             <br/>value ranges from 0.0 to 1.0. Similar to above <b><i>bri</i></b> parameter, except this has been normalized to [0.0 - 1.0] range.
             <br/>
             When dimming command is not used, this parameter will be 0.0 for "off" and 1.0 for "on" command.
        </dd>
    </dl>
</script>
